<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Выбери правильный перевод</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: Arial, sans-serif;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #fff;
    }
    body > .container {
      max-width: 600px;
      width: 100%;
      padding: 20px;
      box-sizing: border-box;
      text-align: center;
    }
    h1 {
      margin-bottom: 0.5em;
      font-size: 2.5em;
    }
    #word {
      font-size: 3.5em;
      margin: 1em 0;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0 auto 1.5em;
      max-width: 400px;
    }
    li {
      margin: 1em 0;
      padding: 1em;
      background: #f0f0f0;
      border-radius: 8px;
      cursor: pointer;
      user-select: none;
      font-size: 1.8em;
      transition: background-color 0.3s;
      text-align: center;
    }
    li.correct {
      background-color: #a6e6a6;
    }
    li.wrong {
      background-color: #e69a9a;
    }
    #feedback {
      margin: 1em 0 1.5em;
      min-height: 2em;
      font-weight: bold;
      font-size: 1.8em;
      color: black;
    }
    #stats {
      display: none; /* скрываем статистику изначально */
      margin-top: 1em;
      font-size: 1.6em;
      font-weight: bold;
    }
    #stats p {
      margin: 0.4em 0;
    }
    button {
      padding: 1em 2em;
      font-size: 1.8em;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background-color: #007bff;
      color: white;
      transition: background-color 0.3s;
      display: block;
      margin: 0 auto;
    }
    button:disabled {
      background-color: #aaa;
      cursor: default;
    }
    button:hover:not(:disabled) {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Выбери правильный перевод</h1>
    <div id="word">...</div>
    <ul id="options"></ul>
    <div id="feedback"></div>
    <button id="exitBtn">Выйти из игры</button>
    <div id="stats">
      <p>Правильных ответов: <span id="correct">0</span></p>
      <p>Всего вопросов: <span id="total">0</span></p>
      <p>Время игры: <span id="time">0.0</span> сек</p>
    </div>
  </div>

<script>
  const words = {
    "cat": "кот",
    "dog": "собака",
    "apple": "яблоко",
    "book": "книга",
    "sun": "солнце",
    "car": "машина",
    "tree": "дерево",
    "water": "вода",
    "house": "дом",
    "bird": "птица"
  };

  const wordElem = document.getElementById('word');
  const optionsElem = document.getElementById('options');
  const feedback = document.getElementById('feedback');
  const stats = document.getElementById('stats');
  const exitBtn = document.getElementById('exitBtn');
  const correctElem = document.getElementById('correct');
  const totalElem = document.getElementById('total');
  const timeElem = document.getElementById('time');

  const wordList = Object.entries(words);
  let correct = 0;
  let total = 0;
  let startTime = null;
  let currentWord = null;
  let acceptingAnswers = true;

  function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function updateStats() {
    correctElem.textContent = correct;
    totalElem.textContent = total;
    if (startTime) { const elapsedSec = ((Date.now() - startTime) / 1000).toFixed(1);
      timeElem.textContent = elapsedSec;
    }
  }

  function nextWord() {
    if (!startTime) startTime = Date.now();
    acceptingAnswers = true;
    feedback.textContent = '';
    const randomIndex = Math.floor(Math.random() * wordList.length);
    currentWord = wordList[randomIndex];
    wordElem.textContent = currentWord[0];

    let options = [currentWord[1]];
    while (options.length < 4) {
      const rand = wordList[Math.floor(Math.random() * wordList.length)][1];
      if (!options.includes(rand)) options.push(rand);
    }
    shuffleArray(options);

    optionsElem.innerHTML = '';
    options.forEach(opt => {
      const li = document.createElement('li');
      li.textContent = opt;
      li.className = '';
      optionsElem.appendChild(li);
    });
  }

  optionsElem.addEventListener('click', e => {
    if (!acceptingAnswers) return;
    if (e.target.tagName !== 'LI') return;

    acceptingAnswers = false;
    total++;

    const selected = e.target.textContent;
    if (selected === currentWord[1]) {
      correct++;
      e.target.classList.add('correct');
      feedback.textContent = 'Правильно!';
    } else {
      e.target.classList.add('wrong');
      feedback.textContent = `Неправильно! Правильный ответ: ${currentWord[1]}`;
      // Подсветить правильный ответ
      Array.from(optionsElem.children).forEach(li => {
        if (li.textContent === currentWord[1]) {
          li.classList.add('correct');
        }
      });
    }

    // Обновляем статистику, но не показываем блок stats
    updateStats();

    // Через 1.5 секунды следующий вопрос, если игра не завершена
    setTimeout(() => {
      nextWord();
    }, 1500);
  });

  exitBtn.addEventListener('click', () => {
    acceptingAnswers = false;
    feedback.textContent = 'Игра завершена. Спасибо за игру!';
    optionsElem.innerHTML = '';
    wordElem.textContent = '';
    exitBtn.disabled = true;

    updateStats();
    stats.style.display = 'block'; // показываем статистику при выходе
  });

  // Запускаем игру
  nextWord();
</script>
</body>
</html>